<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Employee">

	<select id="selectOrgnztList" resultType="egovframework.bat.domain.insa.Orgnztinfo">
		SELECT
			 ORGNZT_ID,
			 ORGNZT_NM,
			 ORGNZT_DC
		FROM COMTNORGNZTINFO
	</select>

        <!-- 원격 및 STG 조회 시 사용하며 ESNTL_ID와 SOURCE_SYSTEM을 제외한 쿼리 -->
        <select id="selectEmployeeList" resultType="egovframework.bat.domain.insa.EmployeeInfo">
                SELECT
                         EMPLYR_ID,
                         ORGNZT_ID,
                         USER_NM,
                         SEXDSTN_CODE,
                         BRTHDY,
                         MBTLNUM,
                         EMAIL_ADRES,
                         OFCPS_NM,
                         EMPLYR_STTUS_CODE,
                         REG_DTTM,
                         MOD_DTTM
                FROM COMTNEMPLYRINFO
        </select>

        <!-- 로컬 DB 조회 시 사용하며 ESNTL_ID와 SOURCE_SYSTEM을 포함한 쿼리 -->
        <select id="selectEmployeeListLocal" resultType="egovframework.bat.domain.insa.EmployeeInfo">
                SELECT
                         ESNTL_ID,
                         EMPLYR_ID,
                         ORGNZT_ID,
                         USER_NM,
                         SEXDSTN_CODE,
                         BRTHDY,
                         MBTLNUM,
                         EMAIL_ADRES,
                         OFCPS_NM,
                         EMPLYR_STTUS_CODE,
                         REG_DTTM,
                         MOD_DTTM
                FROM COMTNEMPLYRINFO
        </select>

	<insert id="insertOrganization" parameterType="egovframework.bat.domain.insa.EmployeeInfo">
		INSERT INTO COMTNORGNZTINFO (ORGNZT_ID, ORGNZT_NM, ORGNZT_DC)
				VALUES (#{orgnztId}, #{orgnztNm}, #{orgnztDc})
			ON DUPLICATE KEY UPDATE
				ORGNZT_NM = VALUES(ORGNZT_NM),
				ORGNZT_DC = VALUES(ORGNZT_DC)
	</insert>

        <!-- STG -> Local 이관 시 사용하며 ESNTL_ID를 포함한 쿼리 -->
        <insert id="insertEmployee" parameterType="egovframework.bat.domain.insa.EmployeeInfo">
                INSERT INTO COMTNEMPLYRINFO
                        (ESNTL_ID, EMPLYR_ID, ORGNZT_ID, USER_NM, SEXDSTN_CODE, BRTHDY, MBTLNUM, EMAIL_ADRES, OFCPS_NM, EMPLYR_STTUS_CODE, REG_DTTM, MOD_DTTM)
                VALUES
                        (#{esntlId}, #{emplyrId}, #{orgnztId}, #{userNm}, #{sexdstnCode}, #{brthdy}, #{mbtlnum}, #{emailAdres}, #{ofcpsNm}, #{emplyrSttusCode}, #{regDttm}, #{modDttm})
                ON DUPLICATE KEY UPDATE
                        ORGNZT_ID = VALUES(ORGNZT_ID),
                        USER_NM = VALUES(USER_NM),
                        SEXDSTN_CODE = VALUES(SEXDSTN_CODE),
                        BRTHDY = VALUES(BRTHDY),
                        MBTLNUM = VALUES(MBTLNUM),
                        EMAIL_ADRES = VALUES(EMAIL_ADRES),
                        OFCPS_NM = VALUES(OFCPS_NM),
                        EMPLYR_STTUS_CODE = VALUES(EMPLYR_STTUS_CODE),
                        REG_DTTM = VALUES(REG_DTTM),
                        MOD_DTTM = VALUES(MOD_DTTM)
        </insert>

        <!-- 원격 -> STG 이관 시 사용하며 ESNTL_ID를 제외한 쿼리 -->
        <insert id="insertEmployeeLegacy" parameterType="egovframework.bat.domain.insa.EmployeeInfo">
                INSERT INTO COMTNEMPLYRINFO
                        (EMPLYR_ID, ORGNZT_ID, USER_NM, SEXDSTN_CODE, BRTHDY, MBTLNUM, EMAIL_ADRES, OFCPS_NM, EMPLYR_STTUS_CODE, REG_DTTM, MOD_DTTM)
                VALUES
                        (#{emplyrId}, #{orgnztId}, #{userNm}, #{sexdstnCode}, #{brthdy}, #{mbtlnum}, #{emailAdres}, #{ofcpsNm}, #{emplyrSttusCode}, #{regDttm}, #{modDttm})
                ON DUPLICATE KEY UPDATE
                        ORGNZT_ID = VALUES(ORGNZT_ID),
                        USER_NM = VALUES(USER_NM),
                        SEXDSTN_CODE = VALUES(SEXDSTN_CODE),
                        BRTHDY = VALUES(BRTHDY),
                        MBTLNUM = VALUES(MBTLNUM),
                        EMAIL_ADRES = VALUES(EMAIL_ADRES),
                        OFCPS_NM = VALUES(OFCPS_NM),
                        EMPLYR_STTUS_CODE = VALUES(EMPLYR_STTUS_CODE),
                        REG_DTTM = VALUES(REG_DTTM),
                        MOD_DTTM = VALUES(MOD_DTTM)
        </insert>

</mapper>
